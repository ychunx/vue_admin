(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26bfc358"],{"5e36":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{attrs:{inline:""}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"角色名称"},model:{value:e.tempSearchObj.roleName,callback:function(t){e.$set(e.tempSearchObj,"roleName",t)},expression:"tempSearchObj.roleName"}})],1),n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")]),n("el-button",{on:{click:e.resetSearch}},[e._v("清空")])],1),n("div",{staticStyle:{"margin-bottom":"20px"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=e.$store.state.user.buttons.indexOf("btn.Role.add"),expression:"$store.state.user.buttons.indexOf('btn.Role.add') != -1"}],attrs:{type:"primary"},on:{click:e.addRole}},[e._v("添加")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=e.$store.state.user.buttons.indexOf("btn.Role.remove"),expression:"$store.state.user.buttons.indexOf('btn.Role.remove') != -1"}],attrs:{type:"danger",disabled:0===e.selectedRoles.length},on:{click:function(t){return e.removeRoles()}}},[e._v("批量删除")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"960px"},attrs:{border:"",stripe:"",data:e.roles},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),n("el-table-column",{attrs:{label:"角色名称"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[s.edit?[n("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:s.roleName,callback:function(t){e.$set(s,"roleName",t)},expression:"row.roleName"}}),n("el-button",{staticClass:"cancel-btn",attrs:{size:"small",icon:"el-icon-refresh",type:"warning"},on:{click:function(t){return e.cancelEdit(s)}}},[e._v(" 取消 ")])]:n("span",[e._v(e._s(s.roleName))])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[n("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=e.$store.state.user.buttons.indexOf("btn.Role.assgin"),expression:"$store.state.user.buttons.indexOf('btn.Role.assgin') != -1"}],attrs:{size:"mini",type:"info",icon:"el-icon-info",title:"分配权限"},on:{click:function(t){return e.$router.push("/acl/role/auth/"+s.id+"?roleName="+s.roleName)}}}),s.edit?n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-check",title:"确定"},on:{click:function(t){return e.updateRole(s)}}}):e._e(),s.edit?e._e():n("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=e.$store.state.user.buttons.indexOf("btn.Role.update"),expression:"$store.state.user.buttons.indexOf('btn.Role.update') != -1"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",title:"修改角色"},on:{click:function(e){s.edit=!0}}}),n("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=e.$store.state.user.buttons.indexOf("btn.Role.remove"),expression:"$store.state.user.buttons.indexOf('btn.Role.remove') != -1"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",title:"删除角色"},on:{click:function(t){return e.removeRole(s)}}})]}}])})],1),n("el-pagination",{staticStyle:{padding:"20px 0"},attrs:{"current-page":e.page,total:e.total,"page-size":e.limit,"page-sizes":[5,10,20,30,40,50,100],layout:"prev, pager, next, jumper, ->, sizes, total"},on:{"current-change":e.getRoles,"size-change":e.handleSizeChange}})],1)},a=[],o=n("c7eb"),i=n("1da1"),r=n("5530"),l=(n("d3b7"),n("d81d"),{name:"RoleList",data:function(){return{listLoading:!0,roles:[],total:0,page:1,limit:5,tempSearchObj:{roleName:""},searchObj:{roleName:""},selectedRoles:[]}},mounted:function(){this.getRoles()},methods:{cancelEdit:function(e){e.roleName=e.originRoleName,e.edit=!1,this.$message.warning("取消角色修改")},updateRole:function(e){var t=this;this.$API.role.updateById({id:e.id,roleName:e.roleName}).then((function(e){t.$message.success(e.message||"更新角色成功!"),t.getRoles(t.page)}))},handleSizeChange:function(e){this.limit=e,this.getRoles()},addRole:function(){var e=this;this.$prompt("请输入新名称","添加角色",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(t){var n=t.value;e.$API.role.save({roleName:n}).then((function(t){e.$message.success(t.message||"添加角色成功"),e.getRoles()}))})).catch((function(){e.$message.warning("取消添加")}))},getRoles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,this.listLoading=!0;var n=this.limit,s=this.searchObj;this.$API.role.getPageList(t,n,s).then((function(t){var n=t.data,s=n.items,a=n.total;e.roles=s.map((function(e){return e.edit=!1,e.originRoleName=e.roleName,e})),e.total=a})).finally((function(){e.listLoading=!1}))},search:function(){this.searchObj=Object(r["a"])({},this.tempSearchObj),this.getRoles()},resetSearch:function(){this.tempSearchObj={roleName:""},this.searchObj={roleName:""},this.getRoles()},removeRole:function(e){var t=this,n=e.id,s=e.roleName;this.$confirm("确定删除 '".concat(s,"' 吗?"),"提示",{type:"warning"}).then(Object(i["a"])(Object(o["a"])().mark((function e(){var s;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$API.role.removeById(n);case 2:s=e.sent,t.getRoles(1===t.roles.length?t.page-1:t.page),t.$message.success(s.message||"删除成功!");case 5:case"end":return e.stop()}}),e)})))).catch((function(){t.$message.info("已取消删除")}))},handleSelectionChange:function(e){this.selectedRoles=e},removeRoles:function(){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{type:"warning"}).then(Object(i["a"])(Object(o["a"])().mark((function t(){var n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.selectedRoles.map((function(e){return e.id})),t.next=3,e.$API.role.removeRoles(n);case 3:t.sent,e.getRoles(),e.$message({type:"success",message:"批量删除成功!"});case 6:case"end":return t.stop()}}),t)})))).then((function(e){})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}}}),c=l,u=(n("d130"),n("2877")),d=Object(u["a"])(c,s,a,!1,null,"3bcacbbe",null);t["default"]=d.exports},"716d":function(e,t,n){},d130:function(e,t,n){"use strict";n("716d")}}]);